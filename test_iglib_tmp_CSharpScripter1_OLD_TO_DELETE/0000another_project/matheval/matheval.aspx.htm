<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>





	<title>CodeProject: Evaluating Mathematical Expressions by Compiling C# Code at Runtime. Free source code and programming help</title>
	
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Description" content="A completely new way of making a mathematical expression evaluator.; Author: Marcin Cuprjak (aka Vlad Tepes); Section: Algorithms &amp; Recipes; Chapter: General Programming">
<meta name="Keywords" content=".NET 1.0, C#, Windows, Visual Studio, Dev, Intermediate,Algorithms &amp; Recipes,General Programming,Free source code, tutorials">
<meta name="Author" content="The Code Project">
<meta name="Rating" content="General">
<meta name="Robots" content="index, follow">
<meta name="Revisit-After" content="1 days">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All topics" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - MFC / C++" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - C#" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - ASP.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - .NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - VB.NET" href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="http://www.codeproject.com/webservices/LoungeRSS.aspx">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="http://www.codeproject.com/info/OpenSearch.xml">
	<link rel="stylesheet" type="text/css" href="matheval.aspx_files/CodeProject.css">	
	<link rel="stylesheet" type="text/css" href="matheval.aspx_files/ForumClassic.css">	
	<!-- base -->
	
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="matheval.aspx_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</script>
	
	<script type="text/javascript" language="Javascript" src="matheval.aspx_files/oncopy.js"></script>
<script type="text/javascript" language="Javascript" src="matheval.aspx_files/jxs.js"></script>
<script type="text/javascript" language="Javascript" src="matheval.aspx_files/bookmark.js"></script>
<script type="text/javascript" language="Javascript" src="matheval.aspx_files/rateitem.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></script>

<script type="text/javascript" language="Javascript" src="matheval.aspx_files/addto.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></script>

<script type="text/javascript" language="Javascript" src="matheval.aspx_files/ShortCuts.js"></script>
<link rel="icon" href="http://69.10.233.10/favicon.ico" type="image/ico">
<link rel="shortcut icon" href="http://69.10.233.10/favicon.ico" type="image/ico">

</head><body style="background-color: rgb(255, 255, 255);">

<table id="ctl00_AT" border="0" cellpadding="0" cellspacing="0">
	<tbody><tr valign="top">
		<td colspan="2">
		<table border="0" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td class="HeaderLogo"><a href="http://69.10.233.10/"><img id="ctl00_Logo" src="matheval.aspx_files/logo225x90.gif" alt="The Code Project" style="border-width: 0px; height: 90px; width: 225px;"></a></td>				 
			<td class="HeaderBanner" align="right" width="100%">
			<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fAdvertisingIdStorageKey%3d5008%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fxoreax_808_leader_728x90.gif%26C%3dFalse%26id%3d5008%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?AdvertisingIdStorageKey=5008&amp;way=ban" target="_blank" rel="nofollow"><img src="matheval.aspx_files/ServeImg.htm" alt="" border="0" width="728" height="90"></a>
			</td>
		</tr>
		<tr>
			<td colspan="2">
			

<table class="MemberNavBar" cellpadding="5" cellspacing="0" width="100%">
<tbody><tr>
<td class="SmallText" style="font-weight: bold;">5,240,431 members and growing! (20,458 online)</td>
<td align="right">



<div id="ctl00_MemberMenu_LoggedOffOptions" class="MemberNavBarText" style="margin: 0pt; padding: 0pt;">
			<a name="SignUp"></a>
<form name="subForm" id="subForm" action="/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx" method="post" style="margin: 0pt; padding: 0pt;">
Email    <input class="SmallText" name="Email" id="Email" style="width: 100px;" type="text">
Password <input class="SmallText" name="Password" id="Password" style="width: 60px;" type="password">
<input value="Sign in" class="FormButton" type="submit">
<script type="text/javascript">
function Join(){document.location.href='/script/Membership/Modify.aspx';return false;}
document.write('<input type="button" class="FormButton" onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign" value="true" />');
</script><input class="FormButton" onclick="return Join();" value="Join" type="button"><input name="fld_quicksign" value="true" type="hidden">
<input checked="checked" name="cookie" id="RememberMeCheck" type="checkbox">
<label for="RememberMeCheck">Remember me?</label>&nbsp;
<a id="ctl00_MemberMenu_SendPassword" href="http://69.10.233.10/script/Membership/SendPassword.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx"><img alt="help" src="matheval.aspx_files/help.gif" align="middle" border="0" width="16" height="16">Lost your password?</a>
</form>

		</div>

</td>
</tr>
</tbody></table>
			</td>
		</tr>
		<tr>
			<td colspan="2">
			
<table class="SiteNavBar" id="tblSiteToolbar" cellpadding="0" cellspacing="0">
<tbody><tr>

<td nowrap="nowrap"><a href="http://69.10.233.10/">Home</a></td><td> &nbsp; </td><td align="right" nowrap="nowrap">Current Site: </td><td class="SelCat" nowrap="nowrap"><a href="http://www.codeproject.com/">Main Site</a></td>
<td nowrap="nowrap"><a href="http://java.codeproject.com/">Java</a></td>
<td nowrap="nowrap"><a href="http://lamp.codeproject.com/">Linux Apache MySQL PHP</a></td>

<td width="100%">&nbsp;</td>
<td id="ctl00_TopNavBar_RightMenus">
	<div id="MenuPos" style="position: relative; width: 380px; height: 22px; top: 1px;">
	<table style="border-width: 0px; height: 20px;" cellpadding="0" cellspacing="0" width="380">
	<tbody><tr valign="middle">
	<td style="border-width: 0pt;" nowrap="nowrap"><a href="http://69.10.233.10/info/FAQ.aspx">Help!</a></td>
<td style="border-width: 0pt;" nowrap="nowrap"><a href="http://69.10.233.10/script/Articles/Latest.aspx">Articles</a></td>
<td style="border-width: 0pt;" nowrap="nowrap"><a href="http://69.10.233.10/script/Forums/List.aspx">Message Boards</a></td>
<td style="border-width: 0pt;" nowrap="nowrap"><a href="http://69.10.233.10/script/Jobs/List.aspx">Job Board</a></td>
<td style="border-width: 0pt;" nowrap="nowrap"><a href="http://69.10.233.10/Lounge.aspx">Lounge</a></td>

	</tr>
	</tbody></table>
	</div>
</td>
		
</tr>

</tbody></table>

			</td>
		</tr>
		</tbody></table>
	</td>
	</tr>
	<tr>
		<td colspan="2" valign="top">
			<a name="_top"></a>
			<table id="ctl00_ArticleTopHeader_HeaderTable" class="ArticleHeader" border="0" cellpadding="3" cellspacing="0" width="100%">
			<tbody><tr valign="top">
				<td class="SmallText">
	<a id="ctl00_ArticleTopHeader_ChapterLink" href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=6">General Programming</a> »
	<a id="ctl00_ArticleTopHeader_SectionLink" href="http://69.10.233.10/KB/recipes/">Algorithms &amp; Recipes</a> »
	<a id="ctl00_ArticleTopHeader_SubsectionLink" href="http://69.10.233.10/KB/recipes/index.aspx?#Algorithms%20&amp;%20Recipes%20-%20General">General</a>
	<span id="ctl00_ArticleTopHeader_SkillLevel" class="ArticleIntermediate">&nbsp;&nbsp;&nbsp; Intermediate</span> <span id="ctl00_ArticleTopHeader_LicenceTerms"></span>
	<br><br>
	<h1><span id="ctl00_ArticleTopHeader_ArticleTitle" class="ArticleTopTitle">Evaluating Mathematical Expressions by Compiling C# Code at Runtime</span></h1>
	<b>By <a href="http://69.10.233.10/script/Articles/MemberArticles.aspx?amid=76357">Marcin Cuprjak (aka Vlad Tepes)</a></b><br><br>
    <span id="ctl00_ArticleTopHeader_ArticleDescr" class="ArticleTopDescr">A completely new way of making a mathematical expression evaluator.</span>	
</td>
				<td class="SmallText" style="width: 210px;">
	<span id="ctl00_ArticleTopHeader_ArticleAttributes">C#, Windows, .NET 1.0, .NET, Visual Studio, Dev</span><br><br>
	<span style="padding-right: 2ex;">Posted</span>: <b>21 Apr 2003</b><br>
	<span style="padding-right: 0.5ex;">Updated</span>: <b>21 Apr 2003</b>
	<br>
	<span style="padding-right: 3.2ex;">Views</span>: <b>107,606</b><br>
</td>
			</tr>
			<tr>
				<td colspan="2">
	<table width="100%">
	<tbody><tr>
	<td></td>
	<td style="white-space: nowrap;" class="SmallText" align="right">
	</td>
	</tr>
	</tbody></table>
</td>
			</tr>
		</tbody></table>
		

		</td>
	</tr>
	<tr valign="top">
		<td id="ctl00_LeftNavCell" class="LHNavBar">
			<div style="text-align: center; padding-top: 5px;">
				<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fAdvertisingIdStorageKey%3d5302%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fIBMdeveloperWorks_150x80.gif%26C%3dFalse%26id%3d5302%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?AdvertisingIdStorageKey=5302&amp;way=ban" target="_blank" rel="nofollow"><img src="matheval.aspx_files/ServeImg_002.htm" alt="" border="0" width="150" height="80"></a>
			</div>
			

<div class="FeatureBlockHeader">Announcements</div>
<div class="FeatureBlockContent RHFeatureBar">


<div style="padding-top: 0px;"><img src="matheval.aspx_files/prize_winner.gif" alt="Comp" style="float: left; margin-left: 8px; margin-right: 9px;" width="10" height="20">
<a href="http://69.10.233.10/Feature/CodeGenComp/">Code Generation<br>comp. $1,000 prize!</a></div>


<div style="margin-top: 4px; margin-bottom: 3px;"><img src="matheval.aspx_files/coffee.gif" alt="Comp" style="float: left; margin-left: 6px; margin-right: 6px;" width="16" height="16">
<a href="http://69.10.233.10/Zones/IBM/">Win CodeProject Coffee!</a></div>

<div style="padding-top: 0px;"><img src="matheval.aspx_files/prize_winner.gif" alt="Comp" style="float: left; margin-left: 8px; margin-right: 9px;" width="10" height="20">
<a id="ctl00_Announcements_CompLink" href="http://69.10.233.10/Feature/ArticleCompetition/">Monthly Competition</a><br clear="all">

<div style="padding-top: 3px; padding-bottom: 5px;"><img src="matheval.aspx_files/staff_sm.gif" alt="Staff" style="float: left; margin-left: 7px; padding-right: 10px; margin-right: 8px;" width="12" height="16">
<a href="http://69.10.233.10/info/jobs/">We're Hiring</a></div>


</div>
</div>
			
			<div class="MenuCat">Services</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Jobs/List.aspx">Job Board</a></div>
<div class="MenuChapter"><a href="http://69.10.233.10/Services/coffee.aspx">Code Project Coffee</a></div>
<div class="MenuChapter"><a href="http://69.10.233.10/Services/TradePub.aspx">Free Magazines</a></div>
<br>
<div id="SectionMenu">
<div class="MenuCat">Chapters</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=1" onclick="return ToggleMenu('Chapter1');">Desktop Development</a></div>
<div class="MenuSectionBlock" id="Chapter1" style="display: none;">
<div class="MI" id="Section1"><a href="http://69.10.233.10/KB/buttons/">Button Controls</a></div>
<div class="MI" id="Section15"><a href="http://69.10.233.10/KB/clipboard/">Clipboard</a></div>
<div class="MI" id="Section2"><a href="http://69.10.233.10/KB/combobox/">Combo &amp; List Boxes</a></div>
<div class="MI" id="Section67"><a href="http://69.10.233.10/KB/dialog/">Dialogs and Windows</a></div>
<div class="MI" id="Section107"><a href="http://69.10.233.10/KB/gadgets/">Desktop Gadgets</a></div>
<div class="MI" id="Section16"><a href="http://69.10.233.10/KB/docview/">Document / View</a></div>
<div class="MI" id="Section4"><a href="http://69.10.233.10/KB/edit/">Edit Controls</a></div>
<div class="MI" id="Section17"><a href="http://69.10.233.10/KB/files/">Files and Folders</a></div>
<div class="MI" id="Section3"><a href="http://69.10.233.10/KB/grid/">Grid &amp; Data Controls</a></div>
<div class="MI" id="Section5"><a href="http://69.10.233.10/KB/list/">List Controls</a></div>
<div class="MI" id="Section6"><a href="http://69.10.233.10/KB/menus/">Menus</a></div>
<div class="MI" id="Section14"><a href="http://69.10.233.10/KB/miscctrl/">Miscellaneous</a></div>
<div class="MI" id="Section18"><a href="http://69.10.233.10/KB/printing/">Printing</a></div>
<div class="MI" id="Section95"><a href="http://69.10.233.10/KB/progress/">Progress Controls</a></div>
<div class="MI" id="Section11"><a href="http://69.10.233.10/KB/selection/">Selection Controls</a></div>
<div class="MI" id="Section19"><a href="http://69.10.233.10/KB/shell/">Shell and IE programming</a></div>
<div class="MI" id="Section68"><a href="http://69.10.233.10/KB/smart/">Smart Client</a></div>
<div class="MI" id="Section8"><a href="http://69.10.233.10/KB/splitter/">Splitter Windows</a></div>
<div class="MI" id="Section9"><a href="http://69.10.233.10/KB/static/">Static &amp; Panel Controls</a></div>
<div class="MI" id="Section10"><a href="http://69.10.233.10/KB/statusbar/">Status Bar</a></div>
<div class="MI" id="Section7"><a href="http://69.10.233.10/KB/tabs/">Tabs &amp; Property Pages</a></div>
<div class="MI" id="Section12"><a href="http://69.10.233.10/KB/toolbars/">Toolbars &amp; Docking windows</a></div>
<div class="MI" id="Section13"><a href="http://69.10.233.10/KB/tree/">Tree Controls</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=2" onclick="return ToggleMenu('Chapter2');">Web Development</a></div>
<div class="MenuSectionBlock" id="Chapter2" style="display: none;">
<div class="MI" id="Section70"><a href="http://69.10.233.10/KB/ajax/">Ajax and Atlas</a></div>
<div class="MI" id="Section27"><a href="http://69.10.233.10/KB/applications/">Applications &amp; Tools</a></div>
<div class="MI" id="Section85"><a href="http://69.10.233.10/KB/asp/">ASP</a></div>
<div class="MI" id="Section89"><a href="http://69.10.233.10/KB/aspnet/">ASP.NET</a></div>
<div class="MI" id="Section28"><a href="http://69.10.233.10/KB/webforms/">ASP.NET Controls</a></div>
<div class="MI" id="Section38"><a href="http://69.10.233.10/KB/ATL-Server/">ATL Server</a></div>
<div class="MI" id="Section29"><a href="http://69.10.233.10/KB/web-cache/">Caching</a></div>
<div class="MI" id="Section91"><a href="http://69.10.233.10/KB/web-image/">Charts, Graphs and Images</a></div>
<div class="MI" id="Section25"><a href="http://69.10.233.10/KB/scripting/">Client side scripting</a></div>
<div class="MI" id="Section30"><a href="http://69.10.233.10/KB/custom-controls/">Custom Controls</a></div>
<div class="MI" id="Section23"><a href="http://69.10.233.10/KB/HTML/">HTML / CSS</a></div>
<div class="MI" id="Section22"><a href="http://69.10.233.10/KB/IP/">Internet / Network</a></div>
<div class="MI" id="Section24"><a href="http://69.10.233.10/KB/ISAPI/">ISAPI</a></div>
<div class="MI" id="Section33"><a href="http://69.10.233.10/KB/server-management/">Site &amp; Server Management</a></div>
<div class="MI" id="Section34"><a href="http://69.10.233.10/KB/session/">Session State</a></div>
<div class="MI" id="Section113"><a href="http://69.10.233.10/KB/silverlight/">Silverlight</a></div>
<div class="MI" id="Section36"><a href="http://69.10.233.10/KB/trace/">Trace and Logs</a></div>
<div class="MI" id="Section31"><a href="http://69.10.233.10/KB/user-controls/">User Controls</a></div>
<div class="MI" id="Section37"><a href="http://69.10.233.10/KB/validation/">Validation</a></div>
<div class="MI" id="Section35"><a href="http://69.10.233.10/KB/viewstate/">View State</a></div>
<div class="MI" id="Section26"><a href="http://69.10.233.10/KB/WAP/">WAP / WML</a></div>
<div class="MI" id="Section32"><a href="http://69.10.233.10/KB/web-security/">Web Security</a></div>
<div class="MI" id="Section20"><a href="http://69.10.233.10/KB/webservices/">Web Services</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=9" onclick="return ToggleMenu('Chapter9');">Enterprise Systems</a></div>
<div class="MenuSectionBlock" id="Chapter9" style="display: none;">
<div class="MI" id="Section98"><a href="http://69.10.233.10/KB/MCMS/">Content Management Server</a></div>
<div class="MI" id="Section99"><a href="http://69.10.233.10/KB/biztalk/">Microsoft BizTalk Server</a></div>
<div class="MI" id="Section102"><a href="http://69.10.233.10/KB/exchange/">Microsoft Exchange</a></div>
<div class="MI" id="Section90"><a href="http://69.10.233.10/KB/office/">Office Development</a></div>
<div class="MI" id="Section101"><a href="http://69.10.233.10/KB/sharepoint/">SharePoint Server</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=3" onclick="return ToggleMenu('Chapter3');">Multimedia</a></div>
<div class="MenuSectionBlock" id="Chapter3" style="display: none;">
<div class="MI" id="Section42"><a href="http://69.10.233.10/KB/audio-video/">Audio and Video</a></div>
<div class="MI" id="Section44"><a href="http://69.10.233.10/KB/directx/">DirectX</a></div>
<div class="MI" id="Section46"><a href="http://69.10.233.10/KB/GDI/">GDI</a></div>
<div class="MI" id="Section47"><a href="http://69.10.233.10/KB/GDI-plus/">GDI+</a></div>
<div class="MI" id="Section43"><a href="http://69.10.233.10/KB/graphics/">General Graphics</a></div>
<div class="MI" id="Section45"><a href="http://69.10.233.10/KB/openGL/">OpenGL</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=4" onclick="return ToggleMenu('Chapter4');">Database</a></div>
<div class="MenuSectionBlock" id="Chapter4" style="display: none;">
<div class="MI" id="Section66"><a href="http://69.10.233.10/KB/database/">Database</a></div>
<div class="MI" id="Section100"><a href="http://69.10.233.10/KB/reporting-services/">SQL Reporting Services</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=8" onclick="return ToggleMenu('Chapter8');">Platforms, Frameworks &amp; Libraries</a></div>
<div class="MenuSectionBlock" id="Chapter8" style="display: none;">
<div class="MI" id="Section83"><a href="http://69.10.233.10/KB/atl/">ATL</a></div>
<div class="MI" id="Section117"><a href="http://69.10.233.10/KB/MFC/">MFC</a></div>
<div class="MI" id="Section88"><a href="http://69.10.233.10/KB/stl/">STL</a></div>
<div class="MI" id="Section84"><a href="http://69.10.233.10/KB/wtl/">WTL</a></div>
<div class="MI" id="Section49"><a href="http://69.10.233.10/KB/COM/">COM / COM+</a></div>
<div class="MI" id="Section76"><a href="http://69.10.233.10/KB/dotnet/">.NET Framework</a></div>
<div class="MI" id="Section92"><a href="http://69.10.233.10/KB/winsdk/">Win32/64 SDK &amp; OS</a></div>
<div class="MI" id="Section108"><a href="http://69.10.233.10/KB/vista/">Vista API</a></div>
<div class="MI" id="Section110"><a href="http://69.10.233.10/KB/vista-security/">Vista Security</a></div>
<div class="MI" id="Section82"><a href="http://69.10.233.10/KB/cross-platform/">Cross Platform</a></div>
<div class="MI" id="Section69"><a href="http://69.10.233.10/KB/game/">Game Development</a></div>
<div class="MI" id="Section73"><a href="http://69.10.233.10/KB/mobile/">Mobile Development</a></div>
<div class="MI" id="Section106"><a href="http://69.10.233.10/KB/WC/">Windows CardSpace</a></div>
<div class="MI" id="Section103"><a href="http://69.10.233.10/KB/WCF/">Windows Communication Foundation</a></div>
<div class="MI" id="Section104"><a href="http://69.10.233.10/KB/WPF/">Windows Presentation Foundation</a></div>
<div class="MI" id="Section105"><a href="http://69.10.233.10/KB/WF/">Windows Workflow Foundation</a></div>
<div class="MI" id="Section119"><a href="http://69.10.233.10/KB/library/">Libraries</a></div>
<div class="MI" id="Section122"><a href="http://69.10.233.10/KB/powershell/">Windows Powershell</a></div>
<div class="MI" id="Section123"><a href="http://69.10.233.10/KB/linq/">LINQ</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=5" onclick="return ToggleMenu('Chapter5');">Languages</a></div>
<div class="MenuSectionBlock" id="Chapter5" style="display: none;">
<div class="MI" id="Section71"><a href="http://69.10.233.10/KB/cpp/">C / C++ Language</a></div>
<div class="MI" id="Section72"><a href="http://69.10.233.10/KB/mcpp/">C++ / CLI</a></div>
<div class="MI" id="Section93"><a href="http://69.10.233.10/KB/cs/">C#</a></div>
<div class="MI" id="Section78"><a href="http://69.10.233.10/KB/msil/">MSIL</a></div>
<div class="MI" id="Section86"><a href="http://69.10.233.10/KB/vbscript/">VBScript</a></div>
<div class="MI" id="Section87"><a href="http://69.10.233.10/KB/vb/">VB.NET</a></div>
<div class="MI" id="Section115"><a href="http://69.10.233.10/KB/vb-interop/">VB6 Interop</a></div>
<div class="MI" id="Section77"><a href="http://69.10.233.10/KB/net-languages/">Other .NET Languages</a></div>
<div class="MI" id="Section21"><a href="http://69.10.233.10/KB/XML/">XML</a></div>
<div class="MI" id="Section96"><a href="http://69.10.233.10/KB/java/">Java</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=6" onclick="return ToggleMenu('Chapter6');">General Programming</a></div>
<div class="MenuSectionBlock" id="Chapter6">
<div class="MIS" id="Section57"><a href="http://69.10.233.10/KB/recipes/">Algorithms &amp; Recipes</a></div>
<div class="MI" id="Section64"><a href="http://69.10.233.10/KB/bugs/">Bugs &amp; Workarounds</a></div>
<div class="MI" id="Section79"><a href="http://69.10.233.10/KB/collections/">Collections</a></div>
<div class="MI" id="Section56"><a href="http://69.10.233.10/KB/security/">Cryptography &amp; Security</a></div>
<div class="MI" id="Section50"><a href="http://69.10.233.10/KB/datetime/">Date and Time</a></div>
<div class="MI" id="Section52"><a href="http://69.10.233.10/KB/DLL/">DLLs &amp; Assemblies</a></div>
<div class="MI" id="Section80"><a href="http://69.10.233.10/KB/exception/">Exception Handling</a></div>
<div class="MI" id="Section81"><a href="http://69.10.233.10/KB/locale/">Localisation</a></div>
<div class="MI" id="Section53"><a href="http://69.10.233.10/KB/macros/">Macros and Add-ins</a></div>
<div class="MI" id="Section54"><a href="http://69.10.233.10/KB/tips/">Programming Tips</a></div>
<div class="MI" id="Section55"><a href="http://69.10.233.10/KB/string/">String handling</a></div>
<div class="MI" id="Section58"><a href="http://69.10.233.10/KB/threads/">Threads, Processes &amp; IPC</a></div>
<div class="MI" id="Section59"><a href="http://69.10.233.10/KB/winhelp/">WinHelp / HTMLHelp</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=10" onclick="return ToggleMenu('Chapter10');">Graphics / Design</a></div>
<div class="MenuSectionBlock" id="Chapter10" style="display: none;">
<div class="MI" id="Section40"><a href="http://69.10.233.10/KB/expression/">Expression</a></div>
<div class="MI" id="Section114"><a href="http://69.10.233.10/KB/usability/">Usability</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=11" onclick="return ToggleMenu('Chapter11');">Development Lifecycle</a></div>
<div class="MenuSectionBlock" id="Chapter11" style="display: none;">
<div class="MI" id="Section51"><a href="http://69.10.233.10/KB/debug/">Debug Tips</a></div>
<div class="MI" id="Section39"><a href="http://69.10.233.10/KB/architecture/">Design and Architecture</a></div>
<div class="MI" id="Section112"><a href="http://69.10.233.10/KB/install/">Installation</a></div>
<div class="MI" id="Section41"><a href="http://69.10.233.10/KB/work/">Work Issues</a></div>
<div class="MI" id="Section126"><a href="http://69.10.233.10/KB/codegen/">Code Generation</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=7" onclick="return ToggleMenu('Chapter7');">General Reading</a></div>
<div class="MenuSectionBlock" id="Chapter7" style="display: none;">
<div class="MI" id="Section60"><a href="http://69.10.233.10/KB/books/">Book Chapters</a></div>
<div class="MI" id="Section61"><a href="http://69.10.233.10/KB/book-reviews/">Book Reviews</a></div>
<div class="MI" id="Section109"><a href="http://69.10.233.10/KB/hardware-review/">Hardware Reviews</a></div>
<div class="MI" id="Section63"><a href="http://69.10.233.10/KB/interviews/">Interviews</a></div>
<div class="MI" id="Section62"><a href="http://69.10.233.10/KB/scrapbook/">Scrapbook</a></div>
<div class="MI" id="Section48"><a href="http://69.10.233.10/KB/system/">Hardware &amp; System</a></div>
</div>
<div class="MenuChapter"><a href="http://69.10.233.10/script/Content/Chapter.aspx?chptId=12" onclick="return ToggleMenu('Chapter12');">Third Party Products</a></div>
<div class="MenuSectionBlock" id="Chapter12" style="display: none;">
<div class="MI" id="Section65"><a href="http://69.10.233.10/KB/showcase/">Product Showcase</a></div>
<div class="MI" id="Section124"><a href="http://69.10.233.10/KB/solution-center/">Solution Center</a></div>
</div>
</div>
<br>
<div class="MenuCat">Feature Zones</div>
<div class="MenuChapter"><a href="http://69.10.233.10/Zones/IBM">IBM DeveloperWorks</a></div>
<div class="MenuChapter"><a href="http://69.10.233.10/Zones/WhitePapers">WhitePapers</a></div>
<div class="MenuChapter"><a href="http://69.10.233.10/Zones/CodeGeneration">Code Generation</a></div>
<div class="MenuChapter"><a href="http://69.10.233.10/Zones/QuestSQL">Quest SQL Zone</a></div>
<br>

			
			<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fAdvertisingIdStorageKey%3d6560%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252f0616_160x600.gif%26C%3dFalse%26id%3d6560%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?AdvertisingIdStorageKey=6560&amp;way=ban" target="_blank" rel="nofollow"><img src="matheval.aspx_files/ServeImg_004.htm" alt="" border="0" width="160" height="600"></a>		
			<img src="matheval.aspx_files/t_002.gif" alt="" width="160" height="1">
		</td>
		<td class="ArticlePane" valign="top">

			
<table class="SearchHeaderBar" cellspacing="0" width="100%">
<tbody><tr>
<td style="white-space: nowrap; width: 60%;" align="right" valign="middle">
<form method="get" action="/info/search.aspx" name="Search" style="margin: 0pt;">
<b>Search &nbsp;</b>
<input class="SmallText" name="artkw" style="width: 200px;">
<select class="SmallText" style="font-weight: bold;" name="sbo">
<option value="kw">Articles</option>
<!--<option value="au">Authors</option>-->
<option value="fm">Messages</option>
<option value="s">Jobs</option>
</select>
<input class="SmallText" style="font-weight: bold;" value=" Go! " type="submit"> &nbsp;
</form>
</td>

<td class="TinyText" style="white-space: nowrap;">
<a href="http://69.10.233.10/info/search.aspx">Advanced Search</a><br>
<a href="http://69.10.233.10/script/Content/SiteMap.aspx">Sitemap</a>

</td>
</tr>
</tbody></table>

			<span id="ctl00_ResultMessage"></span>
			
			<div id="ctl00_ArtDiv">
			<table border="0" cellpadding="0" cellspacing="0" width="100%">	
			<tbody><tr valign="top">
				<td valign="top">
				    
<table>

</table>



					
<div class="SmallText">
<img src="matheval.aspx_files/print.gif" alt="print" style="vertical-align: middle;" width="16" height="16">
<a id="ctl00_ArticleHeaderLinks_PrintLnk" href="http://69.10.233.10/KB/recipes/matheval.aspx?display=Print">Print</a> &nbsp;

<img src="matheval.aspx_files/report.gif" alt="Broken Article?" style="vertical-align: middle;" width="16" height="16">
<a id="ctl00_ArticleHeaderLinks_BrokenLnk" href="http://69.10.233.10/script/Articles/Report.aspx?aid=3988">Report Article</a> &nbsp;

 &nbsp;
 &nbsp;

<img src="matheval.aspx_files/discuss.gif" alt="Discuss" style="vertical-align: middle;" width="15" height="16">
<a href="#_comments">Discuss</a> &nbsp;

<img src="matheval.aspx_files/mail.gif" alt="Recommend Article" style="vertical-align: middle;" width="16" height="16">&nbsp;<a id="ctl00_ArticleHeaderLinks_Recommend" href="http://69.10.233.10/script/common/TellFriend.aspx?obtid=2&amp;obid=3988">Send&nbsp;to&nbsp;a&nbsp;friend</a>	
</div>
				</td>
				<td style="text-align: right; white-space: nowrap; width: 100px;">
				<table id="CurRat"><tbody><tr><td>            
<table><tbody><tr>
<td style="white-space: nowrap;" class="SmallText" align="right"> 
<span id="ctl00_ArticleRating_VoteLabel">43 votes for this Article.</span></td>
<td><table border="1" cellpadding="0" cellspacing="0">
			<tbody><tr>
				<td bgcolor="White" width="20" height="7"><img src="matheval.aspx_files/red.gif" align="center" border="0" width="20" height="7"></td>
				<td bgcolor="White" width="20" height="7"><img src="matheval.aspx_files/red.gif" align="center" border="0" width="20" height="7"></td>
				<td bgcolor="White" width="20" height="7"><img src="matheval.aspx_files/red.gif" align="center" border="0" width="20" height="7"></td>
				<td bgcolor="White" width="20" height="7"><img src="matheval.aspx_files/red.gif" align="center" border="0" width="20" height="7"></td>
				<td bgcolor="White" width="20" height="7" nowrap="nowrap"><img src="matheval.aspx_files/red.gif" align="center" border="0" width="1" height="7"></td>
			</tr>
		</tbody></table>
		</td>
</tr>
<tr id="ctl00_ArticleRating_PopularityRow">
			<td colspan="2" class="SmallText" align="right">
<a id="ctl00_ArticleRating_PopularityLnk" title="Calculated as rating x Log10(# votes)" href="http://69.10.233.10/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 6.65</a>
<span id="ctl00_ArticleRating_PopularityLbl"></span><span id="ratingVal">Rating: <b>4.07</b> out of 5</span></td>
		</tr>
		
</tbody></table>



</td>
				<td>            
<div>
<table class="HistTable" title="Voting Distribution. Recent data only"><tbody><tr><td><img src="matheval.aspx_files/pollcol.gif" alt="3 votes, 7.0%" title="3 votes, 7.0%" border="0" width="10" height="2"><br>1</td>
<td><img src="matheval.aspx_files/pollcol.gif" alt="1 vote, 2.3%" title="1 vote, 2.3%" border="0" width="10" height="1"><br>2</td>
<td><img src="matheval.aspx_files/pollcol.gif" alt="1 vote, 2.3%" title="1 vote, 2.3%" border="0" width="10" height="1"><br>3</td>
<td><img src="matheval.aspx_files/pollcol.gif" alt="8 votes, 18.6%" title="8 votes, 18.6%" border="0" width="10" height="5"><br>4</td>
<td><img src="matheval.aspx_files/pollcol.gif" alt="30 votes, 69.8%" title="30 votes, 69.8%" border="0" width="10" height="20"><br>5</td>
</tr></tbody></table>
</div>



</td></tr></tbody></table>
				</td>
			</tr>
			</tbody></table>
			
			
			
			
						
			
			
			
			
			
			
			
			
			
			
			<span id="intelliTXT">
			<div id="contentdiv">
			
			<!-- Main Page Contents Start -->
			

<!-- Article Starts -->

<h2>Introduction</h2>
<p>There are many articles on creating mathematical expression parsers
(i.e. for displaying 3D functions where user inputs the formulas
manually).&nbsp;Most of them are based on lexical analysis, grammar
definitions etc. With C# there is a solution for making mathematical
expression evaluator in a completely new way: by compiling code at
runtime. </p><p>Let's assume that we want to create an application that would calculate 3D function like that: 
</p><p><strong>z = f(x,y)</strong> 
</p><p>But we want to let the user input function formula manually (we don't know what the formula will look like). 
</p><p>A solution to deal with that task in 10 minutes is: 
</p><ol>
<li>Let the user input the function 
</li><li>Compile that function into memory 
</li><li>Run the function with given x and y 
</li><li>Do something with result z value </li></ol>
<p><br>To do that in a couple of minutes we would need a class with virtual method:</p><pre lang="cs"><span class="code-keyword">namespace</span> MathEval<br>{<br> <span class="code-keyword">public</span> <span class="code-keyword">class</span> MyClassBase<br> {<br>  <span class="code-keyword">public</span> MyClassBase()<br>  {<br>  }<br>  <span class="code-keyword">public</span> <span class="code-keyword">virtual</span> <span class="code-keyword">double</span> eval(<span class="code-keyword">double</span> x,<span class="code-keyword">double</span> y)<br>  {<br>   <span class="code-keyword">return</span> <span class="code-digit">0</span>.<span class="code-digit">0</span>;<br>  }<br> }<br>}<br></pre>
<p>all we need more is a parser/evaluator class which would compile
function body into assembly (created in memory) and calculate function
result:</p><div class="SmallText" id="premain1" style="width: 100%; cursor: pointer;"><img preid="1" src="matheval.aspx_files/minus.gif" id="preimg1" width="9" height="9"><span preid="1" style="margin-bottom: 0pt;" id="precollapse1"> Collapse</span></div><pre style="margin-top: 0pt; display: block;" id="pre1" lang="cs"><br><span class="code-keyword">using</span> System;<br><span class="code-keyword">using</span> System.Reflection;<br><span class="code-keyword">using</span> System.Windows.Forms;<br><span class="code-keyword">namespace</span> MathEval<br>{<br> <span class="code-keyword">public</span> <span class="code-keyword">class</span> MathExpressionParser<br> {<br>  MyClassBase myobj = <span class="code-keyword">null</span>;<br>  <span class="code-keyword">public</span> MathExpressionParser()<br>  {<br>  }<br>  <span class="code-keyword">public</span> <span class="code-keyword">bool</span> init(<span class="code-keyword">string</span> expr)<br>  {<br>   Microsoft.CSharp.CSharpCodeProvider cp<br>                                = <span class="code-keyword">new</span> Microsoft.CSharp.CSharpCodeProvider();<br>   System.CodeDom.Compiler.ICodeCompiler ic = cp.CreateCompiler();<br>   System.CodeDom.Compiler.CompilerParameters cpar<br>                         = <span class="code-keyword">new</span> System.CodeDom.Compiler.CompilerParameters();<br>   cpar.GenerateInMemory = <span class="code-keyword">true</span>;<br>   cpar.GenerateExecutable = <span class="code-keyword">false</span>;<br>   cpar.ReferencedAssemblies.Add(<span class="code-string">"</span><span class="code-string">system.dll"</span>);<br>   cpar.ReferencedAssemblies.Add(<span class="code-string">"</span><span class="code-string">matheval.exe"</span>); <br>   <strong><span class="code-keyword">string</span> src = <span class="code-string">"</span><span class="code-string">using System;"</span>+<br>    <span class="code-string">"</span><span class="code-string">class myclass:MathEval.MyClassBase"</span> + <br>    <span class="code-string">"</span><span class="code-string">{"</span>+<br>    <span class="code-string">"</span><span class="code-string">public myclass(){}"</span>+<br>    <span class="code-string">"</span><span class="code-string">public override double eval(double x,double y)"</span>+<br>    <span class="code-string">"</span><span class="code-string">{"</span>+<br>    <span class="code-string">"</span><span class="code-string">return "</span>+ expr +<span class="code-string">"</span><span class="code-string">;"</span>+<br>    <span class="code-string">"</span><span class="code-string">}"</span>+<br>    <span class="code-string">"</span><span class="code-string">}"</span>;<br></strong>   System.CodeDom.Compiler.CompilerResults cr<br>                                   = ic.CompileAssemblyFromSource(cpar,src);<br>   <span class="code-keyword">foreach</span> (System.CodeDom.Compiler.CompilerError ce <span class="code-keyword">in</span> cr.Errors)<br>    MessageBox.Show(ce.ErrorText); <br><br>   <span class="code-keyword">if</span> (cr.Errors.Count == <span class="code-digit">0</span> &amp;&amp; cr.CompiledAssembly != <span class="code-keyword">null</span>)<br>   {<br>    Type ObjType = cr.CompiledAssembly.GetType(<span class="code-string">"</span><span class="code-string">myclass"</span>);<br>    <span class="code-keyword">try</span><br>    {<br>     <span class="code-keyword">if</span> (ObjType != <span class="code-keyword">null</span>)<br>     {<br>      myobj = (MyClassBase)Activator.CreateInstance(ObjType);<br>     }<br>    }<br>    <span class="code-keyword">catch</span> (Exception ex)<br>    {<br>     MessageBox.Show(ex.Message);<br>    }<br>    <span class="code-keyword">return</span> <span class="code-keyword">true</span>;<br>   }<br>   <span class="code-keyword">else</span> <br>    <span class="code-keyword">return</span> <span class="code-keyword">false</span>;<br>  }<br>  <strong><span class="code-keyword">public</span> <span class="code-keyword">double</span> eval(<span class="code-keyword">double</span> x,<span class="code-keyword">double</span> y)<br>  {<br>   <span class="code-keyword">double</span> val = <span class="code-digit">0</span>.<span class="code-digit">0</span>;<br>   <span class="code-keyword">if</span> (myobj != <span class="code-keyword">null</span>)<br>   {<br>     val = myobj.eval(x,y);<br>   }<br>   <span class="code-keyword">return</span> val;<br>  }<br></strong> }<br>}<br></pre>
<p>Take a look at the init() method. All we need it to do is to create
an assembly(in memory) with a class "myclass" derived from MyBaseClass.
Note that "eval" method contains the formula given by the user at
runtime. Also note that cpar.ReferencedAssemblies.Add("matheval.exe");
defines a reference to the application currently being created.<br>Then we can call myclass.eval method as many times as we want to:</p><pre lang="cs"><br>MathExpressionParser mp = <span class="code-keyword">new</span> MathExpressionParser();<br><strong>mp.init(<span class="code-string">"</span><span class="code-string">Math.Sin(x)*y"</span>);<br></strong><br><br><span class="code-keyword">for</span>(<span class="code-keyword">int</span> i=0;i&lt;1000000;i++)<br>{<br><strong> mp.eval((<span class="code-keyword">double</span>)i,(<span class="code-keyword">double</span>)i);<br></strong>}<br></pre>
<p>Compiled code is of course much faster than any other solution used to parse and evaluate expressions.</p>
<p>A few things to do:</p>
<ul>
<li>Let the user input formulas as "xy*sin(x+y)" or "x^2+y^2" and convert them to c# "x*y*Math.Sin(x+y)" "x*x + y*y" etc... 
</li><li>Do some error checking/handling other than compiler errors. 
</li><li>Freeing and recreating the in-memory-assembly with another formula. 
</li><li>Enjoy the code :)</li></ul>
<p>PS: special thanks to AcidRain for some ideas :)</p>



<!-- Article Ends -->


			<!-- Main Page Contents End -->
			
			</div>
			</span>
			
			<form name="aspnetForm" method="post" action="matheval.aspx" id="aspnetForm" style="margin: 0pt; padding: 0pt;">
		<div>
		<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTEwMDUyNjYzMjhkZJIE2Pu9Y41rrSC8YUz10qHaHiBH" type="hidden">
		</div>
		

			
			<h2>License</h2>
			<div id="ctl00_LicenseTerms"><p>This
article has no explicit license attached to it but may contain usage
terms in the article text or the download files themselves. If in doubt
please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="http://69.10.233.10/info/Licenses.aspx">here</a></p></div>
			
			<h2>About the Author</h2>
			
					
            
<table border="0" cellpadding="0" cellspacing="5" width="100%">
<tbody><tr valign="top">
<td id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable" style="width: 155px;" valign="top">
	<b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=76357">Marcin Cuprjak (aka Vlad Tepes)</a></b><br><br>
	<center><img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" src="matheval.aspx_files/9510D54E-2587-4668-893B-FAF3A2381BFB.jpg" style="border-width: 0px;"></center><br>
	<span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType" class="SmallText"></span>
		
</td>
		
<td>
	<br>	

	<table>
	<tbody><tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow">
			<td class="SmallText" nowrap="nowrap">Occupation: </td>
			<td width="100%"><span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle" class="SmallText">Architect</span></td>
		</tr>
		

	

	<tr id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow">
			<td class="SmallText">Location: </td>
			<td width="100%"><span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation" class="SmallText"><img src="matheval.aspx_files/PL.gif" alt="Poland" width="16" height="11"> Poland</span></td>
		</tr>
		
	</tbody></table>
	
</td>
</tr>
</tbody></table>

					<br>
				
			
			<table id="ctl00_PopularArticlesRow" border="0" cellpadding="0" cellspacing="0" width="100%">
			<tbody><tr valign="top">
				<td style="width: 100%;">
					<h2>Other popular Algorithms &amp; Recipes articles:</h2><ul><li><a href="http://69.10.233.10/KB/recipes/Differentiation.aspx">Symbolic Differentiation</a><div class="SmallText">This article demonstrates differentiating expressions using a stack and displaying the input expression and its derivative.</div></li><li><a href="http://69.10.233.10/KB/recipes/colorspace1.aspx">Manipulating colors in .NET - Part 1</a><div class="SmallText">Understand and use color models in .NET</div></li><li><a href="http://69.10.233.10/KB/recipes/graphs_astar.aspx">C#: A-Star is born</a><div class="SmallText">Understand graphs and A* path-finding algorithm with C#</div></li><li><a href="http://69.10.233.10/KB/recipes/sota_expression_evaluator.aspx">State of the Art Expression Evaluation</a><div class="SmallText">A tutorial on how to realize an expression evaluator in CSharp with ANTLR</div></li><li><a href="http://69.10.233.10/KB/recipes/FastMathParser.aspx">Fast mathematical expressions parser</a><div class="SmallText">Code for a fast math parser library.</div></li></ul>
					<h2></h2>				
				</td>
				<td>
					<iframe src="matheval.aspx_files/ServeHTML.htm" scrolling="no" width="299" frameborder="0" height="247"></iframe>
				</td>
			</tr>
		</tbody></table>
		
		
			<div id="ctl00_AddTo_AddTo" style="margin: 10px;">
<script language="JavaScript" type="text/javascript">
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "SmallText Bold", "AddTo") 
</script><span class="SmallText Bold">Add this article to: </span> <a class="AddTo" title="Add this page to Digg" onclick="return addto(0);" href="#"><img src="matheval.aspx_files/AddTo_Digg.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Del.icio.us" onclick="return addto(1);" href="#"><img src="matheval.aspx_files/AddTo_Delicious.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Google" onclick="return addto(2);" href="#"><img src="matheval.aspx_files/AddTo_Google.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Windows Live" onclick="return addto(3);" href="#"><img src="matheval.aspx_files/AddTo_Live.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Yahoo! MyWeb" onclick="return addto(4);" href="#"><img src="matheval.aspx_files/AddTo_Yahoo.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Technorati" onclick="return addto(5);" href="#"><img src="matheval.aspx_files/AddTo_Technorati.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Blink" onclick="return addto(6);" href="#"><img src="matheval.aspx_files/AddTo_Blink.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Facebook" onclick="return addto(7);" href="#"><img src="matheval.aspx_files/AddTo_Facebook.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Furl" onclick="return addto(8);" href="#"><img src="matheval.aspx_files/AddTo_Furl.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Simpy" onclick="return addto(9);" href="#"><img src="matheval.aspx_files/AddTo_Simpy.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Reddit" onclick="return addto(10);" href="#"><img src="matheval.aspx_files/AddTo_Reddit.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Newsvine" onclick="return addto(11);" href="#"><img src="matheval.aspx_files/AddTo_Newsvine.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Stumbleupon" onclick="return addto(12);" href="#"><img src="matheval.aspx_files/AddTo_stumbleupon.png" align="absmiddle" border="0" width="16" height="16"></a>  <a class="AddTo" title="Add this page to Mr. Wong" onclick="return addto(13);" href="#"><img src="matheval.aspx_files/AddTo_MrWong.png" align="absmiddle" border="0" width="16" height="16"></a>  
</div>
			
			<table id="ctl00_RateArticleRow" class="RatingBar" border="0" cellpadding="0" cellspacing="0" width="100%">
			<tbody><tr>
				<td><a href="#_top">Article Top</a></td>
				<td align="right">            
<table cellpadding="0" cellspacing="0" width="100%"><tbody><tr>

	
	
	<td id="voteTbl" style="white-space: nowrap;" class="SmallText" align="right">
	
		<table><tbody><tr>
		<td id="ctl00_RateArticle_SignIn" nowrap="nowrap"><a href="#SignUp">Sign Up</a> to vote for this article</td>
				
		
		
		
		
		<td><span id="ctl00_RateArticle_ErrorMessage"></span></td>
		</tr></tbody></table>
	</td>
</tr></tbody></table>



</td>
			</tr>
		</tbody></table>
		
			</form>
			
			<div style="padding: 10px; overflow: hidden; text-align: center; white-space: nowrap;">
				<script type="text/javascript">document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fAdvertisingIdStorageKey%3d6323%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fWholeTomato_AutoSuggest_468x60_Original_newfont.gif%26C%3dFalse%26id%3d6323%22%20alt%3d%22The%20intellisense%20upgrade%20for%20Visual%20Studio%20.NET%20-%20make%20your%20IDE%20as%20smart%20as%20you.%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</script><a href="http://www.codeproject.com/Redir.aspx?AdvertisingIdStorageKey=6323&amp;way=ban" target="_blank" rel="nofollow"><img src="matheval.aspx_files/ServeImg_003.htm" alt="The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you." border="0" width="468" height="60"></a>
				<iframe src="matheval.aspx_files/ServeLinks.htm" scrolling="no" width="300" frameborder="0" height="60"></iframe>					  
			</div>

			<a name="_comments"></a><!-- Forum Start -->
<div id="_MessageBoard" onclick="return SwitchMessage(event, null)">
	<table id="ForumTable" class="Frm_MainTable" cellpadding="0" cellspacing="0">
		<tbody><tr>
			<td class="Frm_MsgAlert"><b>You must <a href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx%3ffid%3d15219%26df%3d90%26mpp%3d25%26noise%3d3%26sort%3dPosition%26view%3dQuick">Sign In</a> to use this message board.</b></td>
		</tr><tr>
			<td><form action="/script/Forums/SetOptions.aspx?floc=%2fKB%2frecipes%2fmatheval.aspx&amp;fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" method="get" style="margin: 0pt; padding: 0pt;">
				<input name="fid" value="15219" type="hidden"><input name="currentQS" value="?floc=%2fKB%2frecipes%2fmatheval.aspx&amp;fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick" type="hidden"><input name="floc" value="/KB/recipes/matheval.aspx" type="hidden"><table border="0" cellpadding="3" cellspacing="0" width="100%">
					<tbody><tr class="Frm_HeaderRow1">
						<td style="white-space: nowrap;"><img src="matheval.aspx_files/forum_faq.gif" alt="FAQ" align="middle" border="0" width="16" height="16">&nbsp;<a href="http://69.10.233.10/script/Forums/FAQ.aspx"><b>FAQ</b></a>&nbsp;</td><td style="white-space: nowrap; text-align: right;">Noise Tolerance<select size="1" class="Frm_DropDown" name="noise">
							<option value="1">Very High</option><option value="2">High</option><option selected="selected" value="3">Medium</option><option value="4">Low</option><option value="5">Very Low</option>
						</select></td><td colspan="2" style="white-space: nowrap; text-align: right;"><img src="matheval.aspx_files/forum_search.gif" alt="Search" align="top" border="0" width="16" height="15">&nbsp;<a href="http://69.10.233.10/script/Forums/Search.aspx?fid=15219">Search Messages</a>&nbsp;</td><td style="text-align: right;"><input value="Set Options" name="submit" class="Frm_Button" type="submit"></td>
					</tr><tr class="Frm_HeaderRow2">
						<td style="width: 100%;">&nbsp;</td><td style="white-space: nowrap; text-align: right;">Layout<select size="1" class="Frm_DropDown" name="view">
							<option selected="selected" value="Quick">Normal</option><option value="Topic">Expand Root Messages</option><option value="Expanded">Expand All Messages</option><option value="Thread">Thread View</option><option value="Normal">No Javascript (slow)</option><option value="Preview">No Javascript Preview</option>
						</select>&nbsp;&nbsp;</td><td style="white-space: nowrap;">Per page<select size="1" class="Frm_DropDown" name="mpp">
							<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
						</select>&nbsp;&nbsp;</td><td colspan="2">&nbsp;</td>
					</tr>
				</tbody></table>
			</form></td>
		</tr><tr>
			<td><a name="xx0xx"></a><table border="0" cellpadding="2" cellspacing="0" width="100%">
				<tbody><tr class="Frm_NavigationBar">
					<td>&nbsp;</td><td>Msgs 1 to 22 of 22 (Total in Forum: 22) (<a href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</a>)</td><td style="text-align: right; white-space: nowrap;"><span class="Frm_HL">First</span><span class="Frm_HL">Prev</span><span class="Frm_HL">Next</span></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table class="Frm_MsgTable" border="0" cellpadding="0" cellspacing="0" width="100%">
				

<!-- Column Headers -->

				<tbody><tr class="Frm_ColumnHeaders">
					<td style="width: 100%;"><table border="0" cellpadding="2" cellspacing="0" width="100%">
						<tbody><tr>
							<td>Subject&nbsp;</td><td class="Frm_MsgAuthor">&nbsp;Author&nbsp;</td><td class="Frm_MsgDate">Date&nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><tr>
					<td><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="5"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F2397839_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx2397839xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2397839" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2397839#xx2397839xx">Completely New?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=63555">Dewey</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">15:28 21 Jan '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2397839_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Where's the new stuff? <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2397839" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=2397839" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2397839" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F2400305_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx2400305xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="2400305" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2400305#xx2400305xx">Re: Completely New?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=76357">Marcin Cuprjak (aka Vlad Tepes)</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">10:33 23 Jan '08 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F2400305_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Didn't you notice that the article was created in 2003 and the approach was quite new at that time... <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2397839" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=2400305" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF2400305" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F1770563_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx1770563xx"></a><img src="matheval.aspx_files/msg_question.gif" alt="Question" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1770563" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1770563#xx1770563xx">What is wrong with double FuncN (params double[] x) ?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=2301293">hreba</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:40 22 Nov '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1770563_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">First of all, thanks for the article, it works perfectly for functions like<br>&nbsp;&nbsp; double Func1 (double x).<br>But when I try<br>&nbsp;&nbsp; double FuncN (params double[] x),<br>I get the error message "Metadata file 'FuncLabGUI.exe' could not be found" ('FuncLabGUI' is my main program).<br><br>If
anybody has a hint, please formulate it as simply as possible, I don't
know very well what I am doing, I simply followed the pattern of
Dracula's article and adapted it a little bit, according to the
suggestions of .Net 2.0 (using CSharpCodeProvider's
CompileAssemblyFromSource method instead of creating a compiler). <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1770563" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1770563" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1770563" style="white-space: nowrap;">3.00/5 (2 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F1695561_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx1695561xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1695561" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1695561#xx1695561xx">Good Work!</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=1853948">gajatko</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">3:17 3 Oct '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1695561_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Good idea, easy to expand. What a pity c# does not support macrodefinitions like in C! <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1695561" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1695561" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1695561" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F1382959_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx1382959xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1382959" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1382959#xx1382959xx">Not applicable for ASP.NET2 applications</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=1895825">ZuZuKin</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">10:10 23 Feb '06 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1382959_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Better go this way:<br><pre>using System;<br>using System.Collections;<br>using System.Reflection;<br><br>public class MathExpressionParser<br>{<br>    public object myobj = null;<br>    public ArrayList errorMessages;<br><br>    public MathExpressionParser()<br>    {<br>        errorMessages = new ArrayList();<br>    }<br>    public bool init(string expr)<br>    {<br>        Microsoft.CSharp.CSharpCodeProvider cp<br>                                     = new Microsoft.CSharp.CSharpCodeProvider();<br>        System.CodeDom.Compiler.ICodeCompiler ic = cp.CreateCompiler();<br>        System.CodeDom.Compiler.CompilerParameters cpar<br>                              = new System.CodeDom.Compiler.CompilerParameters();<br>        cpar.GenerateInMemory = true;<br>        cpar.GenerateExecutable = false;<br>        cpar.ReferencedAssemblies.Add("system.dll");<br>        string src = "using System;" +<br>         "class myclass " +<br>         "{ " +<br>         "public myclass(){} " +<br>         "public static double eval(double x) " +<br>         "{ " +<br>         "return " + expr + "; " +<br>         "} " +<br>         "} ";<br>        System.CodeDom.Compiler.CompilerResults cr<br>            = ic.CompileAssemblyFromSource(cpar, src);<br>        foreach (System.CodeDom.Compiler.CompilerError ce in cr.Errors)<br>            errorMessages.Add(ce.ErrorText);<br><br>        if (cr.Errors.Count == 0 &amp;&amp; cr.CompiledAssembly != null)<br>        {<br>            Type ObjType = cr.CompiledAssembly.GetType("myclass");<br>            try<br>            {<br>                if (ObjType != null)<br>                {<br>                    myobj = Activator.CreateInstance(ObjType);<br>                }<br>            }<br>            catch (Exception ex)<br>            {<br>                errorMessages.Add(ex.Message);<br>            }<br>            return true;<br>        }<br>        else<br>            return false;<br>    }<br>    public double eval(double x)<br>    {<br>        double val = 0.0;<br>        Object[] myParams = new Object[1] { x };<br>        if (myobj != null)<br>        {<br>            System.Reflection.MethodInfo evalMethod = myobj.GetType().GetMethod("eval");<br>            val = (double)evalMethod.Invoke(myobj, myParams);<br>        }<br>        return val;<br>    }<br>}</pre><br><b>Usage:</b><br><pre>MathExpressionParser mp = new MathExpressionParser();<br>        mp.init(txtFormula.Text.Trim());<br>        if (mp.errorMessages.Count != 0)<br>        {<br>            theMessageBox.Show("Expression is not valid.");<br>            for (int i = 1; i &lt;= mp.errorMessages.Count; i++)<br>            {<br>                theMessageBox.Show(mp.errorMessages[i - 1].ToString());<br>            }<br>            return;<br>        }<br>        theMessageBox.Show(str(mp.eval((double)5)));</pre><br><br><br> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1382959" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1382959" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1382959" style="white-space: nowrap;">3.00/5 (2 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F1088652_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx1088652xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1088652" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1088652#xx1088652xx">Very Nice</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=1017153">msaroka</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">13:48 20 Apr '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1088652_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">This is excelent.  It has a lot of uses, more then just math.<img src="matheval.aspx_files/smiley_OMG.gif" title="OMG" align="top"> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1088652" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1088652" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1088652" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel" id="F1085553_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx1085553xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1085553" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1085553#xx1085553xx">"matheval.exe"</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=403532">xorenko</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">1:11 17 Apr '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1085553_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">great exapmle!<br>a little thing i'd correct : for sake of modularity i'd use something like <br>AppDomain.CurrentDomain.FriendlyName<br>instead of "matheval.exe"<br><br> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1085553" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1085553" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1085553" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdSel" id="F850206_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx850206xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="850206" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=850206#xx850206xx">Extremely insecure!</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=996024">ekolis</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">16:59 14 Jun '04 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F850206_h1" style="">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Isn't
this method extremely insecure? Either that or you'd have to filter out
everything that's not math code, and if you do that, you've already
written a parser! <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=850206" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=850206" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF850206" style="white-space: nowrap;">4.00/5 (2 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote Rt HdUnSel" id="F567556_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx567556xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="567556" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=567556#xx567556xx">How to unload an assembly?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=216838">Heng Ma</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">11:48 30 Jul '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F567556_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">It
is cool to create a piece of code, compile and run it on fly. We can
pass different expressions to the init method to create many instances
and used in different parts of a running program. My question is how is
the memory be managed. Is there a way to unload one of the assemblies
that no longer needed? <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=567556" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=567556" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF567556" style="white-space: nowrap;">2.00/5 (1 vote) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F1054459_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx1054459xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="1054459" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1054459#xx1054459xx">Re: How to unload an assembly?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=65438">tuxic</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">10:01 7 Mar '05 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F1054459_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">That
can't be done. Instead AppDomains can be unloaded, however to
communicate with a classes/instances in another AppDomain you have to
use remoting. (Intra-process remoting is supposedly fast) <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=567556" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=1054459" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF1054459" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HiVote Rt HdUnSel" id="F485073_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx485073xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="485073" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=485073#xx485073xx">What about Microsoft.JScript.Eval()?</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=307046">onc</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:59 29 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F485073_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I
think using Microsoft.JScript.Eval() (or simple helper class in JScript
compiled into separate assembly) for this purpose is much simpler and
more efficient than emmiting and compiling code in-memory or not.<br><br> <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=485073" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=485073" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF485073" style="white-space: nowrap;">5.00/5 (4 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F480702_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx480702xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="480702" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=480702#xx480702xx">Generate IL directly</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=357864">hsauro</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">20:48 22 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F480702_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2"><br>There
is example code at the borland site which shows how to generate IL
directly, this might be a more efficient way to evaulate expressions.<br><br>http://dotnet.borland.com/samples/Dynamic.CIL.demo.zip<br><br>Herbert Sauro <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480702" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=480702" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF480702" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F481163_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx481163xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="481163" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=481163#xx481163xx">Re: Generate IL directly</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=38829"><code>leppie</code></a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:02 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F481163_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Eventually just mapping all the functions to .NET functions and building an evaluation stack would be the fasted. <br><br><small><b>I rated this article 2 by mistake. It deserves more. I wanted to get to the second page... - vjedlicka 3:33 25 Nov '02</b></small><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480702" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=481163" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF481163" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F485088_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx485088xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="485088" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=485088#xx485088xx">Re: Generate IL directly</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/usersuss.gif" alt="suss" width="14" height="15"></td><td class="Frm_MsgAuthor">Kris Vandermotten</td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">5:25 29 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F485088_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Generating IL directly has many advantages.<br><br>Of
course, what you are really doing is writing a compiler for your own
expression language. This article basically suggests the alternative of
not writing your own compiler, but using the C# one. Consider this
approach as being "quick and dirty", but it works.<br><br>Anyway, if
you want to know about IL generation, have a look at the excellent
paper at http://www.dina.dk/~sestoft/rtcg/rtcg.pdf . This paper
discusses runtime code generation in a partial evaluation context, as
an optimization technique. It also lists benchmark results. <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480702" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=485088" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF485088" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgRtDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd Rt HdUnSel" id="F480617_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="16"><a name="xx480617xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="480617" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=480617#xx480617xx">Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=32286">Blake Coverett</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">17:26 22 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F480617_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 16px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Don't
let the way the CodeDom interfaces appear to work fool you though -
when you 'compile in memory' like that it still just creates temp files
and spawns csc.exe as a whole separate process. I found that rather
depressing.<br><br>The resulting lesson is, while it's efficient to
eval that in a tight loop the compilation process is even more
expensive than you might guess. <br><br>--<br>-Blake (com/bcdev/blake)<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=480617" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF480617" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F480814_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx480814xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="480814" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=480814#xx480814xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=12424">Jonathan de Halleux</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">0:02 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F480814_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Could you give more details about that ? <br><br>Jonathan de Halleux.<br><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=480814" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF480814" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F480960_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="34"><a name="xx480960xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="480960" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=480960#xx480960xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=15383">Rama Krishna</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">4:12 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F480960_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 34px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Well
actually there is a way to compile the stuff in process i.e. without
launching csc.exe. Look at Microsoft.CShrap.Compiler class :-<br><br><a href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfMicrosoftCSharpCompilerClassTopic.asp?frame=true">http://msdn.microsoft.com/library/en-us/cpref/html/frlrfMicrosoftCSharpCompilerClassTopic.asp?frame=true</a>[<a target="_blank" title="New Window" href="http://msdn.microsoft.com/library/en-us/cpref/html/frlrfMicrosoftCSharpCompilerClassTopic.asp?frame=true">^</a>] <br><br><a href="http://www.megryan.co.uk/">Meg Rules</a><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=480960" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF480960" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F481161_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="52"><a name="xx481161xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="481161" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=481161#xx481161xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=38829"><code>leppie</code></a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:00 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F481161_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 52px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">That will launch csc too <br><br><small><b>I rated this article 2 by mistake. It deserves more. I wanted to get to the second page... - vjedlicka 3:33 25 Nov '02</b></small><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=481161" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF481161" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F481165_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="70"><a name="xx481165xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="481165" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=481165#xx481165xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=15383">Rama Krishna</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">8:06 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F481165_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 70px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">Nope. <br><br>CSC internally uses that class. <br><br><a href="http://www.megryan.co.uk/">Meg Rules</a><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=481165" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF481165" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HdUnSel" id="F481508_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="88"><a name="xx481508xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="481508" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=481508#xx481508xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=32286">Blake Coverett</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">17:48 23 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F481508_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 88px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">No,
leppie is quite correct. Both the CodeDom and the C# specific
interfaces just end up launching csc.exe. Yes, this seems unlikely but
it is quite true, try it for yourself. <br><br>The easiest experiment
it to write a snippet of code using either interface, ensure it
operates as expected, and then rename csc.exe and discover it no longer
works. You can also just dig around in the IL disassembly for the
classes, that's what I did a year or two ago. It was a surprise to me
at the time as well. <br><br>--<br>-Blake (com/bcdev/blake)<br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=481508" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF481508" style="white-space: nowrap;"></span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd HiVote HdUnSel" id="F481730_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="106"><a name="xx481730xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="481730" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=481730#xx481730xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=15383">Rama Krishna</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">2:46 24 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F481730_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 106px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">It
is not true with the Microsoft.CSharp.Compiler class. It does compile
InMemory. Actually it calls InMemoryCompile function is cscompd.dll.
Which is what csc.exe ends up calling. Look at csc.exe using dependency
viewer. And also look at the diassembly of the
Microsoft.CSharp.Compiler class. <b>Rememeber This is not a CodeDOM class</b>. <br><br><a href="http://www.megryan.co.uk/">Meg Rules</a><br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=481730" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF481730" style="white-space: nowrap;">4.57/5 (3 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr class="Quick">
					<td class="Frm_MsgDivide"><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="1"></td>
				</tr>
<!-- Start Message head -->

				<tr class="MsgHd LoVote HdUnSel" id="F482260_h0">
					<td width="100%"><table class="QuickHd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" width="116"><a name="xx482260xx"></a><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"></td><td class="Frm_MsgSubject"><a id="DynMessLink" name="482260" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=482260#xx482260xx">Re: Compiling In Memory</a></td><td style="width: 20px; white-space: nowrap;"><img src="matheval.aspx_files/member_sm.gif" title="member" alt="member" border="0" height="16"></td><td class="Frm_MsgAuthor"><a href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=32286">Blake Coverett</a></td><td class="Frm_MsgDate" style="vertical-align: top; white-space: nowrap;">14:41 24 Apr '03 &nbsp;</td>
						</tr>
					</tbody></table></td>
				</tr><!-- End Message head -->

				<tr id="F482260_h1" style="display: none;">
					<td style="width: 100%;"><table class="QuickBd" border="0" cellpadding="0" cellspacing="0" width="100%">
						<tbody><tr>
							<td class="Frm_MsgIndent" style="width: 116px;"></td><td class="MsgBd BdSel"><table border="0" cellpadding="0" cellspacing="5" width="100%">
								<tbody><tr>
									<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
										<tbody><tr>
											<td colspan="2">I
went back and looked again - and you are right, the problem with the
Microsoft.CSharp.Compiler class isn't exactly the way I remembered it.
It does invoke the unmanaged compiler code via a function shim not by
launching csc.exe in another process - but it doesn't expose a way to
compile in memory. (Which is what this thread was originally about.)<br><br>In summary:<br><br>If
you use the CodeDom interface you get the appearance of compiling in
memory, but really it uses temp files and a separate process.<br><br>If
you use the CSharp.Compiler class it doesn't spawn another process but
there's no illusion of compiling into memory at all. You have to
provide a full path to the output assembly on disk. (Meaning you can't
even use isolated storage.)<br><br>The combination of these two made
compiling on the fly much less appealing that I'd originally thought
for the problem domains I was dealing with.<br><br>regards,<br>-Blake <br></td>
										</tr><tr style="vertical-align: middle;">
											<td class="Frm_MsgFt"><a class="Frm_MHL" href="http://69.10.233.10/script/Membership/LogOn.aspx?rp=%2fKB%2frecipes%2fmatheval.aspx">Sign In</a>·<a class="Frm_MHL" href="http://69.10.233.10/KB/recipes/matheval.aspx?fid=15219&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=480617" title="View Thread">View Thread</a>·<a class="Frm_MHL" href="http://69.10.233.10/script/Forums/View.aspx?fid=15219&amp;msg=482260" title="Get permanent link">PermaLink</a></td><td class="Frm_MsgFt" style="text-align: right;"><span id="MVF482260" style="white-space: nowrap;">2.75/5 (3 votes) </span></td>
										</tr>
									</tbody></table></td>
								</tr>
							</tbody></table></td>
						</tr>
					</tbody></table></td>
				</tr><tr>
					<td><img src="matheval.aspx_files/t.gif" alt="" border="0" width="1" height="5"></td>
				</tr>
			</tbody></table></td>
		</tr><tr>
			<td><table cellpadding="2" cellspacing="0" width="100%">
				<tbody><tr class="Frm_Footer">
					<td>Last Visit: Saturday, June 21, 2008 1:58 PM &nbsp; &nbsp; Last Update:Saturday, June 21, 2008 1:58 PM</td><td style="text-align: right; white-space: nowrap;"></td>
				</tr>
			</tbody></table></td>
		</tr>
	</tbody></table>
</div><p class="SmallText"><img src="matheval.aspx_files/msg_general.gif" alt="General" align="top" width="16" height="16"> General &nbsp;&nbsp; <img src="matheval.aspx_files/msg_news.gif" alt="News" align="top" width="16" height="16"> News &nbsp;&nbsp; <img src="matheval.aspx_files/msg_question.gif" alt="Question" align="top" width="16" height="16"> Question &nbsp;&nbsp; <img src="matheval.aspx_files/msg_answer.gif" alt="Answer" align="top" width="16" height="16"> Answer &nbsp;&nbsp; <img src="matheval.aspx_files/msg_joke.gif" alt="Joke" align="top" width="16" height="16"> Joke &nbsp;&nbsp; <img src="matheval.aspx_files/msg_rant.gif" alt="Rant" align="top" width="16" height="16"> Rant &nbsp;&nbsp; <img src="matheval.aspx_files/msg_admin.gif" alt="Admin" align="top" width="16" height="16"> Admin &nbsp;&nbsp; </p>
<!-- Forum End -->




			
			</div>
			<table width="100%">
			<tbody><tr valign="top">
				<td class="TinyText" align="left">
				    <a id="ctl00_PermaLink" href="http://69.10.233.10/script/Articles/Article.aspx?aid=3988">PermaLink</a> | 
					<a id="ctl00_PrivacyLink" href="http://69.10.233.10/info/privacy.aspx"> 
						Privacy </a> |
					<a id="ctl00_TermsOfUseLink" href="http://69.10.233.10/info/TermsOfUse.aspx">Terms 
					of Use</a>
					<br>Last Updated: 21 Apr 2003<br>
					Editor: <a id="ctl00_ArticleEditor" href="http://69.10.233.10/script/Membership/Profiles.aspx?mid=1">Chris Maunder</a><br>
				</td>
				<td class="TinyText" align="right" valign="top">
					Copyright 2003 by Marcin Cuprjak (aka Vlad Tepes)<br>Everything else
					Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2008 <br>
					Web11 |
					<a id="ctl00_AdvertiseLink" href="http://69.10.233.10/info/MediaKit.aspx">Advertise on the Code Project </a>
				</td>
			</tr>
			
			</tbody></table>
			
			<center>
				
			</center>
		</td>
</tr>
<tr>
	<td colspan="2" align="center">
		



		</td>
</tr>
</tbody></table>

<br>
<script type="text/javascript" language="Javascript">//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></script>

<script type="text/javascript" language="Javascript" src="matheval.aspx_files/TogglePre.js"></script>
<script type="text/javascript" language="Javascript" src="matheval.aspx_files/menu132_com.js"></script>
<script type="text/javascript" language="Javascript" src="matheval.aspx_files/TopNavBar.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></script>


<div style="position: absolute; visibility: visible; z-index: 101; width: 386px; height: 22px; top: 126px; left: 598px;"><div class="NavBarMain" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 40px; height: 16px; padding-left: 5px; padding-top: 2px; left: 7px; top: 2px;">Help!</div><div class="NavBarMain" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 55px; height: 16px; padding-left: 5px; padding-top: 2px; left: 55px; top: 2px;">Articles</div><div class="NavBarMain" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 115px; height: 16px; padding-left: 5px; padding-top: 2px; left: 118px; top: 2px;">Message Boards</div><div class="NavBarMain" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 75px; height: 16px; padding-left: 5px; padding-top: 2px; left: 241px; top: 2px;">Job Board</div><div class="NavBarMain" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 55px; height: 16px; padding-left: 5px; padding-top: 2px; left: 324px; top: 2px;">Lounge</div></div><div class="NavBarCont" style="position: absolute; visibility: hidden; z-index: 102; width: 198px; height: 104px; top: 0pt; left: 0pt;"><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 183px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 5px;">What is 'The Code Project'?</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 183px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 24px;">General FAQ</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 183px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 43px;">Post a Question</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 183px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 62px;">Site Directory</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 183px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 81px;">About Us</div></div><div class="NavBarCont" style="position: absolute; visibility: hidden; z-index: 102; width: 158px; height: 161px; top: 0pt; left: 0pt;"><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 5px;">Latest</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 24px;">Search</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 43px;">Most Popular</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 62px;">Beginner Articles</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 81px;">Topic List</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 100px;">Submit an Article</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 119px;">Update an Article</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 143px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 138px;">Article Competition</div></div><div class="NavBarCont" style="position: absolute; visibility: hidden; z-index: 102; width: 183px; height: 389px; top: 0pt; left: 0pt;"><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 5px;">ASP.NET</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 24px;">ATL / WTL / STL</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 43px;">C++ / MFC</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 62px;">(Managed) C++/CLI</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 81px;">C#</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 100px;">COM</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 119px;">Hardware</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 138px;">LINQ and .NET 3.5</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 157px;">.NET Framework</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 176px;">OS / SysAdmin</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 195px;">Silverlight</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 214px;">SQL and Database</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 233px;">VB.NET</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 252px;">Web Development</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 271px;">WPF / WCF / WF</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 290px;">XML / XSL</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 309px;">General Discussions</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 328px;">Suggestions / Site Bugs</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 347px;">The Soapbox</div><div class="NavBarSub" style="overflow: hidden; position: absolute; visibility: inherit; cursor: pointer; width: 168px; height: 16px; padding-left: 5px; padding-top: 2px; left: 5px; top: 366px;">All Message Boards...</div></div></body></html>